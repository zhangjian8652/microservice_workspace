package com.globalroam.matchmove.test;

import com.matchmove.mmpay.api.HttpRequest;
import com.matchmove.mmpay.api.ResourceException;
import com.matchmove.mmpay.api.UnsupportedMethodException;
import org.junit.Test;

import javax.crypto.BadPaddingException;
import javax.crypto.IllegalBlockSizeException;
import javax.crypto.NoSuchPaddingException;
import javax.crypto.ShortBufferException;
import java.io.UnsupportedEncodingException;
import java.net.URISyntaxException;
import java.security.InvalidAlgorithmParameterException;
import java.security.InvalidKeyException;
import java.security.NoSuchAlgorithmException;
import java.security.NoSuchProviderException;
import java.security.spec.InvalidKeySpecException;
import java.util.HashMap;
import java.util.Map;

/**
 * Author: zhangjian
 * Date :2017/5/23.
 * Des:
 */
public class WalletTest extends BaseTest{


    @Test
    public void getWallet() throws UnsupportedEncodingException, NoSuchAlgorithmException, ResourceException, URISyntaxException, UnsupportedMethodException, InvalidKeyException, InvalidKeySpecException, ShortBufferException, NoSuchPaddingException, BadPaddingException, InvalidAlgorithmParameterException, NoSuchProviderException, IllegalBlockSizeException {

        if (this.connection.authenticate(user)) {
            System.out.println("Already authenticated");
        } else {
            // Use OAuth login
            this.connection.authenticate(user, password);
        }

        this.connection.authenticate(this.user, this.password);
        System.out.println("wallets~GET: " + this.connection.consume("users/wallets", HttpRequest.METHOD_GET));
        //response : {"date":{"expiry":"2025-08","issued":"2017-05-23"},"number":"6377021902293743","image":{"small":"https://vcard-assets.s3.amazonaws.com/sg/products/mmvwallet/card-small.png","large":"https://vcard-assets.s3.amazonaws.com/sg/products/mmvwallet/card-large.png","medium":"https://vcard-assets.s3.amazonaws.com/sg/products/mmvwallet/card-medium.png"},"funds":{"withholding":{"amount":"0.00","currency":"SGD"},"available":{"amount":"0.00","currency":"SGD"}},"holder":{"name":"jian"},"details":{"transfer_out_limits":{"post_kyc":{"lifetime_count_limit":null,"daily_transactional_limit":null,"allowed":1,"daily_count_limit":null,"weekly_count_limit":null,"monthly_transactional_limit":null,"weekly_transactional_limit":null,"lifetime_transactional_limit":999999999999,"monthly_count_limit":null,"unit_transaction_limit":1000},"current":{"lifetime_transactional":0,"monthly_count":0,"monthly_transactional":0,"daily_count":0,"daily_transactional":0,"weekly_count":0,"lifetime_count":0,"weekly_transactional":0},"pre_kyc":{"lifetime_count_limit":null,"daily_transactional_limit":null,"allowed":1,"daily_count_limit":null,"weekly_count_limit":null,"monthly_transactional_limit":null,"weekly_transactional_limit":null,"lifetime_transactional_limit":999999999999,"monthly_count_limit":null,"unit_transaction_limit":500}},"deduct_limits":{"post_kyc":{"lifetime_count_limit":null,"daily_transactional_limit":null,"allowed":1,"daily_count_limit":null,"weekly_count_limit":null,"monthly_transactional_limit":null,"weekly_transactional_limit":null,"lifetime_transactional_limit":999999999999,"monthly_count_limit":null,"unit_transaction_limit":1000},"current":{"lifetime_transactional":0,"monthly_count":0,"monthly_transactional":0,"daily_count":0,"daily_transactional":0,"weekly_count":0,"lifetime_count":0,"weekly_transactional":0},"pre_kyc":{"lifetime_count_limit":null,"daily_transactional_limit":null,"allowed":1,"daily_count_limit":null,"weekly_count_limit":null,"monthly_transactional_limit":null,"weekly_transactional_limit":null,"lifetime_transactional_limit":999999999999,"monthly_count_limit":null,"unit_transaction_limit":500}},"transfer_in_limits":{"post_kyc":{"lifetime_count_limit":null,"daily_transactional_limit":null,"allowed":1,"daily_count_limit":null,"weekly_count_limit":null,"monthly_transactional_limit":null,"weekly_transactional_limit":null,"lifetime_transactional_limit":999999999999,"monthly_count_limit":null,"unit_transaction_limit":1000},"current":{"lifetime_transactional":0,"monthly_count":0,"monthly_transactional":0,"daily_count":0,"daily_transactional":0,"weekly_count":0,"lifetime_count":0,"weekly_transactional":0},"pre_kyc":{"lifetime_count_limit":null,"daily_transactional_limit":null,"allowed":1,"daily_count_limit":null,"weekly_count_limit":null,"monthly_transactional_limit":null,"weekly_transactional_limit":null,"lifetime_transactional_limit":999999999999,"monthly_count_limit":null,"unit_transaction_limit":500}},"remittance_limits":{"post_kyc":{"lifetime_count_limit":null,"daily_transactional_limit":null,"allowed":1,"daily_count_limit":null,"weekly_count_limit":null,"monthly_transactional_limit":null,"weekly_transactional_limit":null,"lifetime_transactional_limit":999999999999,"monthly_count_limit":null,"unit_transaction_limit":1000},"current":{"lifetime_transactional":0,"monthly_count":0,"monthly_transactional":0,"daily_count":0,"daily_transactional":0,"weekly_count":0,"lifetime_count":0,"weekly_transactional":0},"pre_kyc":{"lifetime_count_limit":null,"daily_transactional_limit":null,"allowed":1,"daily_count_limit":null,"weekly_count_limit":null,"monthly_transactional_limit":null,"weekly_transactional_limit":null,"lifetime_transactional_limit":999999999999,"monthly_count_limit":null,"unit_transaction_limit":500}},"min_load_limit":1,"fee":0,"network_type":"mastercard","load_limits":{"post_kyc":{"lifetime_count_limit":null,"daily_transactional_limit":null,"allowed":1,"daily_count_limit":null,"weekly_count_limit":null,"monthly_transactional_limit":null,"weekly_transactional_limit":null,"lifetime_transactional_limit":999999999999,"monthly_count_limit":null,"unit_transaction_limit":1000},"current":{"lifetime_transactional":0,"monthly_count":0,"monthly_transactional":0,"daily_count":0,"daily_transactional":0,"weekly_count":0,"lifetime_count":0,"weekly_transactional":0},"pre_kyc":{"lifetime_count_limit":null,"daily_transactional_limit":null,"allowed":1,"daily_count_limit":null,"weekly_count_limit":null,"monthly_transactional_limit":null,"weekly_transactional_limit":null,"lifetime_transactional_limit":999999999999,"monthly_count_limit":null,"unit_transaction_limit":500}},"unload_limits":{"post_kyc":{"lifetime_count_limit":null,"daily_transactional_limit":null,"allowed":1,"daily_count_limit":null,"weekly_count_limit":null,"monthly_transactional_limit":null,"weekly_transactional_limit":null,"lifetime_transactional_limit":999999999999,"monthly_count_limit":null,"unit_transaction_limit":1000},"current":{"lifetime_transactional":0,"monthly_count":0,"monthly_transactional":0,"daily_count":0,"daily_transactional":0,"weekly_count":0,"lifetime_count":0,"weekly_transactional":0},"pre_kyc":{"lifetime_count_limit":null,"daily_transactional_limit":null,"allowed":1,"daily_count_limit":null,"weekly_count_limit":null,"monthly_transactional_limit":null,"weekly_transactional_limit":null,"lifetime_transactional_limit":999999999999,"monthly_count_limit":null,"unit_transaction_limit":500}},"max_load_limit":1000,"topup_limits":{"post_kyc":{"lifetime_count_limit":null,"daily_transactional_limit":null,"allowed":1,"daily_count_limit":null,"weekly_count_limit":null,"monthly_transactional_limit":null,"weekly_transactional_limit":null,"lifetime_transactional_limit":999999999999,"monthly_count_limit":null,"unit_transaction_limit":1000},"current":{"lifetime_transactional":0,"monthly_count":0,"monthly_transactional":0,"daily_count":0,"daily_transactional":0,"weekly_count":0,"lifetime_count":0,"weekly_transactional":0},"pre_kyc":{"lifetime_count_limit":null,"daily_transactional_limit":null,"allowed":1,"daily_count_limit":null,"weekly_count_limit":null,"monthly_transactional_limit":null,"weekly_transactional_limit":null,"lifetime_transactional_limit":999999999999,"monthly_count_limit":null,"unit_transaction_limit":500}}},"id":"caf0860f15ceb718e853fe669fc12983","status":{"is_active":true,"text":"active"}}
    }

    @Test
    public void createWallet() throws UnsupportedEncodingException, NoSuchAlgorithmException, ResourceException, URISyntaxException, UnsupportedMethodException, InvalidKeyException, InvalidKeySpecException, ShortBufferException, NoSuchPaddingException, BadPaddingException, InvalidAlgorithmParameterException, NoSuchProviderException, IllegalBlockSizeException {
        if (this.connection.authenticate(user)) {
            System.out.println("Already authenticated");
        } else {
            // Use OAuth login
            this.connection.authenticate(user, password);
        }
        this.connection.authenticate(this.user, this.password);
        System.out.println("wallets~POST: " + this.connection.consume("users/wallets", HttpRequest.METHOD_POST));
        // response : {"date":{"expiry":"2025-08","issued":"2017-05-23"},"number":"6377021902293743","image":{"small":"https://vcard-assets.s3.amazonaws.com/sg/products/mmvwallet/card-small.png","large":"https://vcard-assets.s3.amazonaws.com/sg/products/mmvwallet/card-large.png","medium":"https://vcard-assets.s3.amazonaws.com/sg/products/mmvwallet/card-medium.png"},"holder":{"name":"jian"},"funds":{"withholding":{"amount":"0.00","currency":"SGD"},"available":{"amount":"0.00","currency":"SGD"}},"details":{"transfer_out_limits":{"post_kyc":{"lifetime_count_limit":null,"daily_transactional_limit":null,"allowed":1,"daily_count_limit":null,"weekly_count_limit":null,"monthly_transactional_limit":null,"weekly_transactional_limit":null,"lifetime_transactional_limit":999999999999,"monthly_count_limit":null,"unit_transaction_limit":1000},"current":{"lifetime_transactional":0,"monthly_count":0,"monthly_transactional":0,"daily_count":0,"daily_transactional":0,"weekly_count":0,"lifetime_count":0,"weekly_transactional":0},"pre_kyc":{"lifetime_count_limit":null,"daily_transactional_limit":null,"allowed":1,"daily_count_limit":null,"weekly_count_limit":null,"monthly_transactional_limit":null,"weekly_transactional_limit":null,"lifetime_transactional_limit":999999999999,"monthly_count_limit":null,"unit_transaction_limit":500}},"deduct_limits":{"post_kyc":{"lifetime_count_limit":null,"daily_transactional_limit":null,"allowed":1,"daily_count_limit":null,"weekly_count_limit":null,"monthly_transactional_limit":null,"weekly_transactional_limit":null,"lifetime_transactional_limit":999999999999,"monthly_count_limit":null,"unit_transaction_limit":1000},"current":{"lifetime_transactional":0,"monthly_count":0,"monthly_transactional":0,"daily_count":0,"daily_transactional":0,"weekly_count":0,"lifetime_count":0,"weekly_transactional":0},"pre_kyc":{"lifetime_count_limit":null,"daily_transactional_limit":null,"allowed":1,"daily_count_limit":null,"weekly_count_limit":null,"monthly_transactional_limit":null,"weekly_transactional_limit":null,"lifetime_transactional_limit":999999999999,"monthly_count_limit":null,"unit_transaction_limit":500}},"transfer_in_limits":{"post_kyc":{"lifetime_count_limit":null,"daily_transactional_limit":null,"allowed":1,"daily_count_limit":null,"weekly_count_limit":null,"monthly_transactional_limit":null,"weekly_transactional_limit":null,"lifetime_transactional_limit":999999999999,"monthly_count_limit":null,"unit_transaction_limit":1000},"current":{"lifetime_transactional":0,"monthly_count":0,"monthly_transactional":0,"daily_count":0,"daily_transactional":0,"weekly_count":0,"lifetime_count":0,"weekly_transactional":0},"pre_kyc":{"lifetime_count_limit":null,"daily_transactional_limit":null,"allowed":1,"daily_count_limit":null,"weekly_count_limit":null,"monthly_transactional_limit":null,"weekly_transactional_limit":null,"lifetime_transactional_limit":999999999999,"monthly_count_limit":null,"unit_transaction_limit":500}},"remittance_limits":{"post_kyc":{"lifetime_count_limit":null,"daily_transactional_limit":null,"allowed":1,"daily_count_limit":null,"weekly_count_limit":null,"monthly_transactional_limit":null,"weekly_transactional_limit":null,"lifetime_transactional_limit":999999999999,"monthly_count_limit":null,"unit_transaction_limit":1000},"current":{"lifetime_transactional":0,"monthly_count":0,"monthly_transactional":0,"daily_count":0,"daily_transactional":0,"weekly_count":0,"lifetime_count":0,"weekly_transactional":0},"pre_kyc":{"lifetime_count_limit":null,"daily_transactional_limit":null,"allowed":1,"daily_count_limit":null,"weekly_count_limit":null,"monthly_transactional_limit":null,"weekly_transactional_limit":null,"lifetime_transactional_limit":999999999999,"monthly_count_limit":null,"unit_transaction_limit":500}},"min_load_limit":1,"fee":0,"network_type":"mastercard","load_limits":{"post_kyc":{"lifetime_count_limit":null,"daily_transactional_limit":null,"allowed":1,"daily_count_limit":null,"weekly_count_limit":null,"monthly_transactional_limit":null,"weekly_transactional_limit":null,"lifetime_transactional_limit":999999999999,"monthly_count_limit":null,"unit_transaction_limit":1000},"current":{"lifetime_transactional":0,"monthly_count":0,"monthly_transactional":0,"daily_count":0,"daily_transactional":0,"weekly_count":0,"lifetime_count":0,"weekly_transactional":0},"pre_kyc":{"lifetime_count_limit":null,"daily_transactional_limit":null,"allowed":1,"daily_count_limit":null,"weekly_count_limit":null,"monthly_transactional_limit":null,"weekly_transactional_limit":null,"lifetime_transactional_limit":999999999999,"monthly_count_limit":null,"unit_transaction_limit":500}},"unload_limits":{"post_kyc":{"lifetime_count_limit":null,"daily_transactional_limit":null,"allowed":1,"daily_count_limit":null,"weekly_count_limit":null,"monthly_transactional_limit":null,"weekly_transactional_limit":null,"lifetime_transactional_limit":999999999999,"monthly_count_limit":null,"unit_transaction_limit":1000},"current":{"lifetime_transactional":0,"monthly_count":0,"monthly_transactional":0,"daily_count":0,"daily_transactional":0,"weekly_count":0,"lifetime_count":0,"weekly_transactional":0},"pre_kyc":{"lifetime_count_limit":null,"daily_transactional_limit":null,"allowed":1,"daily_count_limit":null,"weekly_count_limit":null,"monthly_transactional_limit":null,"weekly_transactional_limit":null,"lifetime_transactional_limit":999999999999,"monthly_count_limit":null,"unit_transaction_limit":500}},"max_load_limit":1000,"topup_limits":{"post_kyc":{"lifetime_count_limit":null,"daily_transactional_limit":null,"allowed":1,"daily_count_limit":null,"weekly_count_limit":null,"monthly_transactional_limit":null,"weekly_transactional_limit":null,"lifetime_transactional_limit":999999999999,"monthly_count_limit":null,"unit_transaction_limit":1000},"current":{"lifetime_transactional":0,"monthly_count":0,"monthly_transactional":0,"daily_count":0,"daily_transactional":0,"weekly_count":0,"lifetime_count":0,"weekly_transactional":0},"pre_kyc":{"lifetime_count_limit":null,"daily_transactional_limit":null,"allowed":1,"daily_count_limit":null,"weekly_count_limit":null,"monthly_transactional_limit":null,"weekly_transactional_limit":null,"lifetime_transactional_limit":999999999999,"monthly_count_limit":null,"unit_transaction_limit":500}}},"id":"caf0860f15ceb718e853fe669fc12983","status":{"is_active":true,"text":"active"}}
    }

}
